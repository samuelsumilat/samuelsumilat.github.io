<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Buku Tamu</title>
    <style>
        /* CSS untuk tampilan postingan */
        .post {
            border: 1px solid #ccc;
            padding: 10px;
            margin: 10px;
            background-color: #f5f5f5;
        }
    </style>
</head>
<body>
    <h1>Buku Tamu</h1>

    <!-- Formulir isian -->
    <form id="guestForm">
        <label for="name">Nama:</label>
        <input type="text" id="name" name="name" required><br>

        <label for="attendance">Kehadiran:</label>
        <select id="attendance" name="attendance">
            <option value="hadir">Hadir</option>
            <option value="belum pasti">Belum Pasti</option>
            <option value="tidak hadir">Tidak Hadir</option>
        </select><br>

        <label for="message">Ucapan:</label>
        <textarea id="message" name="message" rows="4" required></textarea><br>

        <input type="submit" value="Kirim">
    </form>

    <!-- Daftar postingan -->
    <div id="posts"></div>

    <script>
        // Fungsi untuk menampilkan data
        function fetchPosts() {
            fetch('https://sheetdb.io/api/v1/kdsonik1p4mdq')
                .then(response => response.json())
                .then(data => {
                    const postsContainer = document.getElementById('posts');
                    postsContainer.innerHTML = '';

                    data.forEach(post => {
                        const postElement = document.createElement('div');
                        postElement.classList.add('post');
                        postElement.innerHTML = `
                            <strong>Nama:</strong> ${post.name}<br>
                            <strong>Kehadiran:</strong> ${post.attendance}<br>
                            <strong>Ucapan:</strong> ${post.message}
                        `;
                        postsContainer.appendChild(postElement);
                    });
                });
        }

        // Menampilkan postingan saat halaman dimuat
        fetchPosts();

        // Fungsi untuk mengirim data ke API
        document.getElementById('guestForm').addEventListener('submit', function (event) {
            event.preventDefault();

            const formData = new FormData(event.target);

            fetch('https://sheetdb.io/api/v1/kdsonik1p4mdq', {
                method: 'POST',
                body: JSON.stringify(Object.fromEntries(formData)),
                headers: {
                    'Content-Type': 'application/json'
                }
            })
            .then(response => response.json())
            .then(() => {
                fetchPosts(); // Memperbarui tampilan dengan data terbaru
                event.target.reset(); // Mengosongkan formulir
            });
        });
    </script>
</body>
</html>
